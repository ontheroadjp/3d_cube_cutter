# 立体切断シミュレーター

Status: Active

## 思考整理ログ + 教育ツール設計ドキュメント（統合・詳細版）

## 0. 本ドキュメントの目的

本ドキュメントは、

- 中学受験算数における最難関分野
  **「立体切断」**
- その学習支援を目的とした
  **立体切断シミュレーター**

について、

- エンジニアリング的内部設計
- 数学（算数）的構造理解
- 教育ツールとしての機能設計

を **同じ重みで扱い、統合的に記述**したものである。

本プロジェクトの本質は、

> **立体を切るツールではなく
> 立体切断の「考え方」を学ばせるエンジンを作ること**

にある。

---

## 1. 開発対象の概要

### 1.1 ツールの基本仕様

- 対象：立方体（将来的に直方体）
- 環境：ブラウザー（Three.js）
- 操作：
  - ユーザーが切断点を3点指定
  - その3点を通る平面で切断
- 表示：
  - 切断後の立体
  - 切り取られた部分
  - 切断面の輪郭線
  - 交点マーカー

---

## 2. 切断点指定における思想的制約

### 2.1 プログラム的制約（重要）

- 各辺に 1cm 単位のスナップポイント
- 頂点もスナップポイントとして含む
- 同一辺上に複数指定不可
- 任意座標入力は不可

ユーザーの操作精度に依存しない。

### 2.2 教育的意味

- 中学受験算数は連続幾何ではない
- 問題は「構造理解」
- 無限の点ではなく、有限の関係性を扱う

---

## 3. 現行実装の成立点と限界

### 3.1 現行ロジック（概要）

- THREE.Plane による平面定義
- CSG による切断
- 平面 × 各辺 → 交点計算
- 距離ベースの重複排除
- ソートして切断面描画

### 3.2 限界

- 浮動小数点誤差
- 頂点/辺上の区別が消える
- 教育的意味を保持できない

---

## 4. 将来実装を見据えた危機意識

### 4.1 必ず必要になる機能

- 切断面の面積
- 辺の長さ
- 体積比
- 展開図
- 自動解説文生成

座標依存のままでは破綻する。

---

## 5. 発想の転換：構造主導アーキテクチャ

### 5.1 採用方針

> **全スナップポイントに ID を付与する**

各スナップポイントは：

- id
- 種別（Vertex / EdgePoint）
- 所属辺・所属面
- 辺上比率

を持つ。

### 5.2 得られる効果

- 誤差ゼロ
- 切断パターン即判定
- 教育的説明との完全一致

---

## 6. 中学受験算数における立体切断の正体

### 6.1 本質的特徴

- 無限の問題は出ない
- **有限個の典型パターン**に分類可能
- 解ける生徒は「型」で見ている

---

## 7. 立体切断の頻出パターン分類（教育基盤）

### 7.1 大分類軸

| 軸 | 内容 |
| --- | --- |
| 頂点数 | 0 / 1 / 2 / 3 |
| 辺上点数 | 0〜3 |
| 比 | 等比 / 不等比 |
| 空間対角線 | 含む / 含まない |

### 7.2 頻出パターン一覧

#### A. 3頂点切断

- 出題頻度：★★★★★
- 切断面：三角形（正三角形が多い）
- **必ず見る：空間対角線**

#### B. 辺3点・同じ比

- 出題頻度：★★★★★
- 切断面：底面と相似
- **必ず見る：垂直な3辺**

#### C. 全中点切断

- 出題頻度：★★★★★
- 切断面：正六角形
- **必ず見る：3本の空間対角線**

#### D. 空間対角線含有型

- 出題頻度：★★★★★（難関校）
- 切断面：正三角形・ひし形

---

## 8. 教育ツールとしての新機能設計（最重要）

ここからが **本ツールの核心価値**。

---

## 9. 新機能①：頻出パターン自動判定

### 概要

- 指定された3点の ID 情報から
- 切断パターンを即座に分類

```
enum CutPattern {
  THREE_VERTEX,
  EDGE_3_EQUAL_RATIO,
  MIDPOINT_ALL,
  SPACE_DIAGONAL_INCLUDED,
}
```

### 教育的効果

- 生徒は「この問題はこの型」と認識
- 解法の迷走を防ぐ

---

## 10. 新機能②：重要な辺・対角線の自動ハイライト

### 概要

各パターンに対し、

- 必ず見るべき辺
- 空間対角線
- 面の対角線

を自動でハイライト表示。

### UI 表示例

- 切断前：

>「この問題では、赤い線だけ見よう」

- 切断後：

>「なぜこの線が重要だったか」

### 教育的効果

- 視線誘導
- 空間把握力の育成
- 無駄な線を描かなくなる

---

## 11. 新機能③：解説文の自動生成

### 解説テンプレ例

#### 3頂点切断の場合：

> 3点が空間的に配置されているため、
> 切断面は空間対角線を含みます。
> この場合、切断面は正三角形になることが多いです。

### 内部構造

- パターン × スナップポイント情報
- → 固定テンプレ + 数値差し込み

### 教育的効果

- 教師の説明と一致
- 自学自習が可能

---

## 12. 新機能④：思考プロセス可視化モード

### 概要

- 一度に切断しない
- 「考える順序」を段階表示

1. 見るべき線を表示
2. 切断面の形を予測
3. 実際に切断
4. 結果と比較

### 教育的効果

- 試行錯誤ではなく論理
- 思考力評価も可能

---

## 13. 新機能⑤：求積・体積計算との連動

- 面積：
  - 構造ベースで正確計算
- 体積：
  - 相似・比を自動抽出
- 解説文に連動：

>「相似なので比は ○：○」

---

## 14. 教育ツールとしての最終像

本ツールは、

- 正解を見せるツールではない
- 考え方を体験させるツール

である。

---

## 15. 結論

この立体切断シミュレーターは、

- Three.js の応用でも
- CSG のデモでもなく

> 中学受験算数の思考体系を
> プログラムとして実装する試み

である。

数値の正確さより、
意味の正確さを最優先する。

---

## 16. 今後「必須」で追加すべき機能一覧（ロードマップ）

本章では、

- 実装コストの高低ではなく
- **このツールが教育ツールとして成立するかどうか**

を基準に、「必須」と判断される機能を列挙する。

---

## 16.1 切断前予測モード（思考強制機能）【最重要】

### 概要

- 切断を実行する前に
  - 切断面の形（例：三角形・四角形・六角形）
  - 相似かどうか
  - 面積比・体積比の予測
    を選択させる。

### UI例

- 「切断面はどれになると思う？」
  - △ 三角形
  - □ 四角形
  - ⬡ 六角形

### 教育的効果

- **「見る → 考える → 確かめる」**を強制
- 当てずっぽう操作を排除
- 上位校が求める思考順序と一致

---

## 16.2 誤答分析・つまずきタイプ判定

### 概要

- 予測と結果の差分を分析し、
  - なぜ間違えたか
    を自動分類する。

### つまずきタイプ例

- 空間対角線を見落としている
- 相似を使える場面に気づいていない
- 辺の比を一次元でしか考えていない

### 出力例

> 今回は「空間対角線を意識できていない」タイプのミスです。

### 教育的効果

- 教師の代替
- 自己診断が可能
- 復習指示が明確になる

---

## 16.3 「なぜその線を見るのか」説明モード

### 概要

ハイライトされた線に対して
**理由を必ず言語化**する。

### 表示例

> この赤い線は、切断面の一辺になります。
> なぜなら、切断平面がこの辺を必ず通るからです。

### 内部設計

- LineID × CutPattern → Explanation

### 教育的効果

- 暗記ではなく因果理解
- ノートに書く説明と完全一致

---

## 16.4 図を描く力を育てる「部分表示モード」

### 概要

- あえて立体を完全には表示しない
- 必要な辺・面だけを段階表示

### モード例

- 初級：全部表示
- 中級：見える面のみ
- 上級：底面＋重要線のみ

### 教育的効果

- 試験本番の紙面再現
- 補助線を引く力の養成

---

## 16.5 教師・指導者向け「解説制御モード」

### 概要

- 解説を
  - 出す / 出さない
  - 段階的に出す
  - 生徒操作後に出す
    を制御可能にする。

### 教育現場での価値

- 授業中のライブ使用
- 解説を「考えさせてから」出せる

---

## 16.6 問題生成エンジン（型ベース）

### 概要

- ランダム生成ではない
- **典型パターン × 難易度**で問題生成

### 生成軸

- パターン種別
- 辺の比（整数限定）
- 見える点数

### 教育的効果

- 網羅学習が可能
- 「この型が苦手」が数値化される

---

## 16.7 紙の解法への変換支援（試験対応）

### 概要

- 3D結果を
  - 2D図
  - ノート用図
    に変換表示。

### 表示内容

- 手書き再現レベルの線
- 余計な奥行き情報を削除

### 教育的効果

- 「3Dツールは試験に役立たない」問題を解消
- 紙に戻れる力を保証

---

## 16.8 思考ログ保存・振り返り機能

### 概要

- 生徒ごとに
  - 見た線
  - 選んだ予測
  - 間違い方
    を保存。

### 教育的効果

- 成長の可視化
- 指導の個別最適化

---

## 16.9 最終ゴール定義（必須到達点）

このツールは、最終的に以下を満たす必要がある。

- 生徒が
  **「切る前に形が想像できる」**
- 生徒が
  **「どの線を見るべきか説明できる」**
- 教師が
  **「なぜその解法になるか」をツールに任せられる**

---

## 17. まとめ：このツールの到達点

このシミュレーターは、

- 立体を切るためのツールではなく
- **思考を切り分けるためのツール**

である。

操作が上達することは目的ではない。
**考えなくても切れる状態は、むしろ失敗**である。
